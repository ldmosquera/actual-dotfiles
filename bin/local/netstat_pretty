#!/bin/sh

{
	echo "Proto\tRecv-Q\tSend-Q\tLocal Address\tForeign Address\tState\tPID/Program name\tTimer"

	netstat -4ntaupo 2>/dev/null |
		sort -t : -k1 -k2n |
		grep -v 'TIME_WAIT' |
		sed 's/off (0.00\/0\/0)/-/g' |
		tail -n +3 |
		tr -s ' ' "\t" |
		#corregir columna de timers
		sed 's/\(\S*\)\t\((.*\/.*)\)$/\1 \2/'
} |
	sed 's/^\(udp.*0\.0\.0\.0:\*\)\(.*\)$/\1\t-\2/g' |
	$HOME/bin/ruby/encolumnar.rb 8
